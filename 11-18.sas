* Example adapted from D. Johnson, Applied Multivariate Methods for Data Analysts;
 DATA COOKIE;
     INPUT (CKG HOLES PROTUS CONTOUR CELLSIZE CELLUNIF
         SURF_RO LOOSE FIRM FRACT COH CHEW MOLAR MOUTH
         CARMEL AROMA SWEET SALTY VAN SOUR BITTER
         SPG W T RATIO INSTRON
         L A B) (2*5.1 2*4.1 4*5.1 3*4.1 5.1 2*4.1 /
            4.1 5.1 6*4.1 6.1 3*5.1 6.2 5.2 6.2);
    CARDS;
 13.8  2.2 3.4 5.0  5.0 12.8 12.5 10.8 7.0 1.4 7.1 12.2 6.1 1.2
 6.5 10.5 8.5 3.5 2.0 0.5 1.8 1.0 429.8 69.2  6.2  9.0 43.16 5.35 11.91
 13.6  2.2 3.2 5.0  4.8 13.1 12.2 10.7 7.0 1.7 7.4 12.3 6.0 1.0
 6.5 10.5 8.2 3.5 2.0 0.5 1.8 0.9 441.4 70.0  6.3 15.1 44.17 6.59 13.08
 13.8  2.0 2.5 5.0  4.9 12.6 12.6 11.2 7.3 1.7 7.1 12.3 6.1 1.3
 6.4 10.3 8.0 3.7 2.0 0.5 2.0 1.1 439.6 62.8  7.0   .  46.42 6.22 13.04
 13.9  2.0 3.2 5.2  5.2 12.9 12.4 10.8 7.1 1.5 7.0 11.7 6.0 1.3
 6.5 10.5 8.0 3.6 2.0 0.5 1.8 1.0 450.7 68.7  6.6   .  44.19 6.72 13.16
 13.3  2.1 3.0 4.9  5.1 12.9 12.3 10.8 7.4 1.9 7.1 12.3 6.2 1.1
 6.6 10.5 8.2 3.7 2.0 0.5 1.8 1.0 438.6 78.3  5.6 11.5 42.53 6.75 12.45
 14.0  2.4 2.2 5.1  5.2 11.8 12.5 10.5 7.0 1.8 6.9 12.4 6.1 1.5
 6.5 10.5 8.2 3.5 2.0 0.4 2.1 0.9 465.1 63.9  7.3   .  45.03 6.65 12.47
 13.3  1.9 3.0 4.9  5.8 11.4 12.5 10.4 7.3 1.9 7.1 12.6 6.3 1.4
 6.5 10.5 8.3 3.6 2.0 0.7 2.0 1.0 474.2 64.0  7.4   .  44.75 5.94 11.62
 13.5  1.7 2.7 4.9  5.1 12.7 12.1 10.4 6.9 1.1 7.1 12.1 6.1 1.2
 6.6 10.4 8.3 3.7 2.0 0.6 1.7 1.0 431.7 75.7  5.7  8.8 47.39 4.35 12.54
 13.9  2.3 2.8 5.1  4.8 12.9 12.7 11.2 7.2 1.5 6.9 12.5 6.1 1.2
 6.4 10.4 8.2 3.5 2.1 0.6 2.1 1.0 427.2 65.7  6.5 12.6 43.14 6.59 12.55
 13.6  2.1 3.5 4.8  4.8 13.0 12.6 10.7 6.9 1.1 7.1 12.5 6.1 1.5
 6.4 10.5 8.2 3.5 2.1 0.6 1.9 1.0 438.3 65.4  6.7 10.7 44.56 5.62 12.57
 13.2  2.7 3.4 5.0  5.0 12.8 12.4 10.8 7.0 1.8 7.0 12.3 6.2 1.0
 6.4 10.5 8.1 3.5 2.1 0.6 1.9 1.0 430.8 75.2  5.7 12.9 43.74 7.40 13.19
 13.4  1.9 3.1 5.0  4.5 13.4 12.3 10.4 6.8 1.2 7.1 12.0 6.0 1.4
 6.4 10.4 8.1 3.5 2.0 0.6 2.0 1.0 437.3 63.6  6.9  4.9 45.79 5.06 13.11
 14.0  1.9 1.8 4.9  6.4 12.7 12.9 10.9 8.1 4.7 6.3 12.1 6.3 2.0
 6.4 10.4 8.4 3.8 2.1 0.5 2.1 1.1 444.0 72.9  6.1   .  45.18 6.71 12.05
 13.5  2.0 3.8 5.2  5.8 11.8 12.5 11.1 7.1 1.4 7.2 12.6 6.2 1.3
 6.6 10.2 8.4 3.5 2.1 0.5 1.9 1.0 437.3 68.4  6.4 13.1 44.49 6.51 11.52
 13.8  1.3 3.1 4.9  5.1 12.5 12.5 10.8 7.5 2.6 7.0 12.8 6.1 1.4
 6.6 10.4 8.5 3.5 2.0 0.5 2.0 1.0 416.9 73.9  5.6 20.1 44.12 7.68 13.31
 13.6  1.7 3.4 4.5  5.7 12.3 12.3 10.5 6.9 1.1 7.2 12.4 6.0 1.5
 6.9 10.7 8.4 3.5 2.0 0.5 1.7 0.9 445.6 67.7  6.6 10.2 45.75 5.92 13.09
 14.0  1.8 2.8 4.8  5.3 12.2 12.6 10.6 7.0 1.4 7.2 11.7 5.7 1.2
 6.5 10.5 8.2 3.5 2.0 0.5 1.7 1.0 433.4 67.2  6.4 12.4 44.01 6.46 12.03
 13.5  3.0 3.3 4.7  5.7 12.3 12.4 10.7 7.2 1.5 7.1 12.7 6.1 1.4
 6.5 10.5 8.1 3.6 2.0 0.5 2.1 1.0 459.7 69.2  6.6   .  46.51 6.14 11.45
  1.6  8.8 2.1 5.3  9.2  8.6  3.3  0.1 5.7 0.2 8.1 13.0 6.1 1.7
 5.9 10.0 7.8 3.6 1.9 0.8 2.0 1.0 470.1 62.2  7.6  3.1 48.17 6.48 15.74
  1.0  9.2 1.2 4.0  7.2  9.7  3.7  0.8 6.1 0.5 7.4 11.5 5.6 1.9
 5.9 10.0 8.1 3.2 1.6 0.5 1.5 1.1 491.3 60.2  8.2   .  48.16 6.77 13.41
  3.9  9.3 2.9 4.9  8.8  9.5  3.3  0.4 5.1 0.2 8.6 12.8 5.7 2.3
 5.3  9.8 8.1 3.4 1.7 0.5 1.6 1.1 458.9 59.1  7.8  5.2 54.30 5.64 14.67
  0.4  8.9 1.0 3.3  7.3 11.0  2.2  0.1 4.7 0.1 8.0 12.1 5.0 1.9
 4.7  9.3 7.4 3.1 1.6 0.8 2.0 0.9 481.6 59.3  8.1  2.3 48.19 6.84 14.59
  0.3  8.9 0.8 3.6  8.8  5.6  2.7  0.0 4.3 0.0 7.4 12.3 5.6 1.8
 5.7  9.9 7.6 3.4 1.6 0.9 2.1 0.9 492.6 55.7  8.8  4.3 47.82 6.11 15.00
  0.1  6.7 0.7 2.5  8.8  5.4  2.9  0.3 4.4 0.1 8.3 12.0 6.1 2.0
 6.0 10.3 8.4 3.7 1.8 0.6 1.8 1.0 501.8 50.5  9.9   .  52.75 5.41 16.00
  1.6 10.2 2.1 6.5  8.9 10.8  3.2  0.1 5.8 0.0 8.8 13.2 6.4 2.0
 5.6  9.8 7.4 3.3 1.7 0.6 1.9 1.1 440.9 75.2  5.9  6.5 42.85 7.50 12.93
  3.3 11.0 1.6 4.1  6.4  9.4  3.0  0.4 5.8 0.1 8.2 12.7 6.0 2.2
 5.0 10.0 8.2 3.4 1.5 0.8 2.0 1.1 487.0 55.0  8.9   .  48.89 5.94 14.48
  5.2 10.3 3.3 5.0  8.1  8.4  3.8  0.2 5.5 0.2 8.0 12.5 5.2 2.4
 5.4  9.8 7.8 3.4 1.9 0.6 1.6 1.1 438.8 65.6  6.7  3.1 46.61 5.74 13.54
  0.4  9.7 1.2 5.3  8.8  9.0  2.1  0.0 5.8 0.1 7.9 12.9 5.9 1.8
 5.2  9.5 7.7 3.4 1.7 0.8 2.0 1.2 474.3 74.9  6.3  4.0 46.45 8.16 15.20
  0.3 10.6 0.6 6.5  9.0  7.0  2.5  0.2 5.8 0.0 8.8 13.4 6.4 2.3
 4.7  9.3 7.9 3.7 1.5 0.6 1.6 1.2 482.3 64.6  7.5   .  47.66 5.28 14.20
  0.2  7.5 1.1 7.3  9.3  8.5  2.8  0.1 5.6 0.0 8.0 12.8 6.3 1.7
 5.5  9.8 7.6 3.4 1.7 0.7 1.8 1.1 445.1 75.7  5.9  1.9 46.84 6.17 15.38
  0.4 10.9 0.9 2.8  7.4 12.3  1.6  0.2 5.0 0.1 7.9 12.7 5.9 1.9
 5.3  9.8 7.5 3.2 2.0 0.7 1.9 1.1 518.9 44.2 11.7   .  44.23 4.34 11.78
  1.0 10.7 1.7 4.4  8.8  9.6  4.6  0.2 7.1 3.6 6.8 12.3 6.4 1.9
 6.0 10.1 8.0 3.6 1.8 0.6 2.0 1.1 517.9 60.6  8.5 10.2 41.30 7.87 12.44
  1.0  8.9 2.0 4.0  8.8  9.4  3.7  0.2 6.1 0.1 8.3 12.8 5.8 1.9
 5.7  9.9 8.1 3.4 1.6 0.7 1.9 1.1 500.5 55.7  9.0  2.1 44.10 7.19 13.95
  0.6  9.1 1.1 3.0  7.8 11.7  2.8  0.2 5.2 0.0 7.9 12.5 6.1 1.7
 5.5  9.8 7.9 3.3 2.1 0.7 2.5 1.1 544.1 55.4  9.8  2.6 45.40 4.38 12.80
  3.2  8.6 2.1 2.7  6.4 10.7  4.0  0.2 5.0 0.1 8.9 13.3 6.2 2.4
 5.7  9.8 7.7 3.5 1.8 0.8 1.9 1.2 523.7 47.6 11.0  1.4 44.58 4.04 12.18
  0.9 10.4 1.3 2.1  7.9 11.3  2.5  0.3 4.7 0.0 8.1 13.2 6.0 2.0
 5.4  9.9 7.6 3.3 1.6 0.6 1.7 1.2 540.1 47.3 11.4   .  44.55 4.92 12.93
  3.8  8.9 1.5 4.3  7.5 11.7  2.9  0.2 5.2 0.1 7.9 12.4 6.3 1.9
 5.5  9.8 7.6 3.3 1.7 0.7 2.2 1.0 473.6 52.6  9.0  3.0 45.02 5.78 13.27
  0.9 10.0 0.3 2.5  5.8 11.9  4.1  0.4 4.7 0.4 7.5 11.6 5.9 1.8
 4.5 10.2 8.3 2.8 1.8 0.5 1.7 1.1 519.1 52.4  9.9   .  45.45 6.25 13.63
  1.5  8.5 1.7 4.1  5.6 11.1  3.4  0.3 4.9 0.0 8.0 12.4 6.0 1.8
 5.4  9.8 7.7 3.8 1.7 0.9 2.0 1.1 473.5 48.4  9.8  3.3 47.55 4.45 14.05
  0.3  5.5 0.5 2.9  8.4  7.9  3.1  0.1 5.0 0.0 7.5 12.6 6.0 2.1
 5.7  9.9 7.7 3.4 1.7 0.6 1.8 1.1 494.0 54.2  9.1  1.6 46.64 5.49 14.40
  0.1  7.4 0.4 3.4  7.5 11.3  2.7  0.1 4.7 0.0 9.1 13.5 6.3 1.8
 5.4  9.7 7.6 3.8 1.8 0.8 2.0 1.1 523.1 58.3  9.0  4.8 47.79 5.25 15.26
  0.0  7.2 0.2 2.5  9.2 11.5  3.3  0.4 4.8 0.5 8.2 11.8 4.9 1.9
 5.1  9.7 7.5 2.6 1.5 0.5 1.4 1.2 533.0 53.8  9.9   .  47.50 5.80 13.87
  1.6 10.6 1.5 5.2  7.8 11.2  4.2  0.3 5.7 0.1 8.1 12.9 5.9 2.0
 5.7  9.9 7.5 3.8 1.9 0.7 1.8 1.1 464.6 65.3  7.1  2.5 46.49 5.97 14.00
  2.0 10.7 1.6 6.9  9.0  8.9  3.7  0.2 6.1 0.2 8.1 12.6 6.1 2.3
 5.7  9.9 7.8 3.4 1.8 0.5 1.7 1.1 476.9 71.8  6.6   .  45.41 6.38 11.52
  2.5 10.2 2.6 6.1  9.3 10.6  3.8  0.1 5.8 0.1 7.8 12.4 6.4 1.5
 5.6 10.0 7.7 3.4 1.9 0.7 2.0 1.0 460.3 70.3  6.6  2.6 43.01 6.98 12.60
  0.3 10.5 0.9 6.2  7.2 11.5  2.9  0.2 5.2 0.1 8.5 13.0 6.1 1.6
 5.1  9.7 7.4 3.4 1.6 0.9 2.0 1.1 479.3 65.3  7.3  2.2 45.59 5.96 14.25
  0.4 10.9 1.1 5.8  9.1  6.3  2.2  0.1 5.0 0.1 7.7 12.6 6.3 1.6
 5.1  9.5 7.4 3.8 2.1 0.6 2.3 1.1 504.0 69.5  7.2  1.3 49.99 4.96 14.25
  1.0  8.8 1.3 5.3  8.1 11.7  2.4  0.2 5.2 0.1 8.1 12.5 5.1 2.0
 4.9  9.6 7.7 3.2 1.6 0.4 1.6 1.2 508.9 59.3  8.6   .  50.58 4.46 14.50
  3.2  8.2 4.9 7.4  7.6 10.6  4.3  0.2 5.3 0.0 8.1 13.0 6.2 1.9
 5.6  9.7 7.6 3.6 1.8 0.6 1.8 1.1 424.6 74.4  5.7  6.7 45.10 7.04 14.20
  1.8  9.7 2.9 7.6  7.5 10.0  3.6  0.2 5.4 0.2 8.2 12.1 5.7 1.8
 5.7  9.8 8.2 3.8 1.9 0.5 1.8 1.1 453.4 76.8  5.9   .  42.15 7.55 12.02
  1.5 10.0 3.0 6.4  6.4 11.0  3.7  0.2 4.9 0.1 8.4 13.5 6.5 2.2
 5.2  9.7 7.5 3.4 1.8 0.6 1.8 1.0 415.9 74.0  5.6  4.1 47.42 6.63 13.12
  0.2  6.0 2.2 7.5 10.4  6.4  2.7  0.2 4.9 0.0 8.8 13.0 5.6 3.0
 4.4  9.3 7.1 3.0 1.4 0.8 1.4 1.3 443.3 73.3  6.0   .  44.90 6.76 13.88
  0.5  6.9 0.8 7.5  7.1 11.4  2.8  0.1 5.3 0.0 8.4 13.2 6.1 1.8
 5.5  9.9 7.6 3.5 2.0 0.6 1.8 1.2 423.9 75.3  5.6  2.6 46.52 6.90 15.71
  0.7  6.4 2.2 6.8 10.4  8.1  1.4  0.2 4.8 0.1 8.7 14.0 6.5 2.3
 5.1  9.4 7.4 3.6 1.5 0.7 1.8 1.1 407.0 80.2  5.1  3.0 43.74 7.87 13.18
RUN;

proc cancorr data=cookie vprefix=flavor wprefix=texture ncan=2;
  var carmel--bitter;
  with surf_ro--mouth;
  run;

proc factor data=cookie method=principal rotate=varimax nfactors=3 out=flavor;
  var carmel--bitter;
  run;
proc factor data=cookie method=principal rotate=varimax nfactors=3 out=texture;
  var surf_ro--mouth;
  run;

data flavor;
  set flavor;
  drop ckg--factor3;
  flavor1=factor1; flavor2=factor2; flavor3=factor3;
  run;
data texture;
  set texture;
  drop ckg--factor3;
  texture1=factor1; texture2=factor2; texture3=factor3;
  run;
data combined;
  merge flavor texture;
  run;
proc cancorr data=combined vprefix=flavor wprefix=texture;
  var flavor1 flavor2 flavor3;
  with texture1 texture2 texture3;
  run;

proc reg data=combined;
  model flavor1 flavor2 flavor3 = texture1 texture2 texture3 / noint;
  mtest;
  run;
  quit;
